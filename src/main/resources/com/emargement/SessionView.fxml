<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>

<BorderPane xmlns="http://javafx.com/javafx/17.0.12"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.emargement.controller.SessionController"
            stylesheets="@styles.css"
            styleClass="root-session">

    <padding>
        <Insets top="20" bottom="20" left="20" right="20"/>
    </padding>

    <top>
        <HBox alignment="CENTER_LEFT" spacing="30" styleClass="session-header">
            <padding>
                <Insets top="10" right="15" bottom="10" left="15"/>
            </padding>
            <VBox spacing="2">
                <Label text="SÃ©ance en cours" styleClass="section-title-medium"/>
                <Label fx:id="headerDateLabel" styleClass="subtitle-text-muted" text="Date Placeholder"/>
            </VBox>
            <Separator orientation="VERTICAL" prefHeight="40"/>
            <VBox spacing="2">
                <Label text="MatiÃ¨re:" styleClass="detail-label-header"/>
                <Label fx:id="headerSubjectLabel" styleClass="detail-value" text="Subject Placeholder"/>
            </VBox>
            <Separator orientation="VERTICAL" prefHeight="40"/>
            <VBox spacing="2">
                <Label text="Heure:" styleClass="detail-label-header"/>
                <Label fx:id="headerTimeLabel" styleClass="detail-value" text="Time Placeholder"/>
            </VBox>
            <HBox alignment="CENTER_RIGHT" HBox.hgrow="ALWAYS" spacing="15">
                <Button fx:id="saveBtn" text="ðŸ’¾ Sauvegarder &amp; Quitter" styleClass="btn-save-session"/>
                <Button fx:id="endSessionBtn" text="âŒ Annuler la sÃ©ance" styleClass="btn-end-session"/>
            </HBox>
        </HBox>
    </top>

    <center>
        <HBox spacing="30" styleClass="main-content-hbox">

            <VBox fx:id="studentListContainer" spacing="15" HBox.hgrow="ALWAYS" styleClass="student-list-panel">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="Liste des Ã©tudiants" styleClass="section-title-medium"/>
                <HBox spacing="10">
                    <Label text="Statut: " styleClass="subtitle-text"/>
                    <Label fx:id="statusSummaryLabel" text="0 PrÃ©sent / 0 Absent / 0 En attente" styleClass="detail-value"/>
                </HBox>
                <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="student-scroll-pane">
                    <VBox fx:id="studentList" spacing="10" styleClass="student-card-list"/>
                </ScrollPane>
            </VBox>

            <VBox alignment="TOP_CENTER" spacing="20" prefWidth="350" minWidth="300" styleClass="code-panel">
                <padding>
                    <Insets top="15" right="15" bottom="15" left="15"/>
                </padding>
                <Label text="Code de la SÃ©ance" styleClass="section-title-medium"/>

                <HBox alignment="CENTER" spacing="0" styleClass="attendance-tabs">
                    <Button fx:id="tabCodeBtn" text="Code" styleClass="tab-btn-active"/>
                    <Button fx:id="tabQRBtn" text="QR Code" styleClass="tab-btn"/>
                    <Button fx:id="tabManualBtn" text="Manuel" styleClass="tab-btn"/>
                </HBox>

                <StackPane VBox.vgrow="ALWAYS" styleClass="attendance-display-area">
                    <VBox fx:id="codeDisplay" alignment="CENTER" spacing="10">
                        <Label text="Code Ã  partager" styleClass="subtitle-text"/>
                        <Label fx:id="codeLabel" styleClass="code-text-large" text="GÃ‰NÃ‰RATION..."/>
                        <Label fx:id="expirationLabel" text="Valable jusqu'Ã  HH:MM:SS" styleClass="subtitle-text-small"/>
                        <Button text="RegÃ©nÃ©rer le code" onAction="#handleGenerateCode" styleClass="btn-toggle-round"/>
                    </VBox>

                    <VBox fx:id="qrDisplay" alignment="CENTER" spacing="10" visible="false" managed="false">
                        <Label text="Scanner le QR Code" styleClass="subtitle-text"/>
                        <ImageView fx:id="qrCodeImage" fitWidth="200" fitHeight="200" styleClass="qr-image">
                            <image>
                                <Image url="/com/emargement/qr-placeholder.png"/>
                            </image>
                        </ImageView>
                        <Label text="Afficher sur grand Ã©cran." styleClass="subtitle-text-small"/>
                    </VBox>
                </StackPane>
            </VBox>
        </HBox>
    </center>

</BorderPane>